<!-- 검색창 및 태그 필터 UI Fragment -->
<div th:fragment="filterUI">
    <!-- 검색창 -->
    <div class="mb-4">
        <div class="flex gap-3 flex-nowrap">
            <input type="text" id="keywordInput" placeholder="축제명을 검색하세요..."
                class="flex-1 min-w-0 px-4 py-2 border border-gray-300 rounded-lg">
            <button type="button" id="searchBtn"
                class="flex-shrink-0 whitespace-nowrap px-4 py-2 bg-main text-white rounded-lg hover:bg-sub-red">
                검색
            </button>
        </div>
    </div>

    <!-- 태그 필터 -->
    <div class="mb-4">
        <div class="flex flex-nowrap gap-1.5 overflow-x-auto">
            <button type="button"
                class="bg-main px-[15px] py-1.5 text-sm rounded-lg border-2 border-white-300 text-white hover:bg-[#FF6A6B] whitespace-nowrap"
                data-tag="자연">
                자연
            </button>
            <button type="button"
                class="bg-main px-[15px] py-1.5 text-sm rounded-lg border-2 border-white-300 text-white hover:bg-[#FF6A6B] whitespace-nowrap"
                data-tag="야간">
                야간
            </button>
            <button type="button"
                class="bg-main px-[15px] py-1.5 text-sm rounded-lg border-2 border-white-300 text-white hover:bg-[#FF6A6B] whitespace-nowrap"
                data-tag="먹거리">
                먹거리
            </button>
            <button type="button"
                class="bg-main px-[15px] py-1.5 text-sm rounded-lg border-2 border-white-300 text-white hover:bg-[#FF6A6B] whitespace-nowrap"
                data-tag="체험">
                체험
            </button>
            <button type="button"
                class="bg-main px-[15px] py-1.5 text-sm rounded-lg border-2 border-white-300 text-white hover:bg-[#FF6A6B] whitespace-nowrap"
                data-tag="계절">
                계절
            </button>
            <button type="button"
                class="bg-main px-[15px] py-1.5 text-sm rounded-lg border-2 border-white-300 text-white hover:bg-[#FF6A6B] whitespace-nowrap"
                data-tag="문화">
                문화
            </button>
            <button type="button"
                class="bg-main px-[15px] py-1.5 text-sm rounded-lg border-2 border-white-300 text-white hover:bg-[#FF6A6B] whitespace-nowrap"
                data-tag="아동">
                아동
            </button>
        </div>
    </div>

    <!-- 지역별 필터 드롭다운 -->
    <div class="mb-4 relative">
        <div class="custom-dropdown w-full">
            <div class="flex items-center justify-between mb-2">
                <span class="text-sm text-gray-600">옵션 선택</span>
            </div>
            <div class="relative">
                <button type="button" id="regionDropdownBtn" 
                    class="w-full flex items-center justify-between px-4 py-2.5 bg-main text-white rounded-lg hover:opacity-90 transition-opacity cursor-pointer">
                    <span id="regionSelectedText">전체 지역</span>
                    <svg class="w-5 h-5 transform transition-transform" id="regionDropdownIcon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>
                <div id="regionDropdownMenu" class="hidden absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto">
                    <div class="region-option px-4 py-2.5 cursor-pointer hover:bg-main hover:text-white transition-colors" data-value="">
                        전체 지역
                    </div>
                    <div th:each="region : ${regionList}" 
                         class="region-option px-4 py-2.5 cursor-pointer hover:bg-main hover:text-white transition-colors" 
                         th:data-value="${region}"
                         th:text="${region}">
                    </div>
                </div>
            </div>
            <!-- 숨겨진 select (실제 값 저장용) -->
            <select id="regionFilter" class="hidden">
                <option value="">전체 지역</option>
                <option th:each="region : ${regionList}" 
                        th:value="${region}" 
                        th:text="${region}"></option>
            </select>
        </div>
    </div>
    
    <!-- 커스텀 지역 드롭다운 JavaScript -->
    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function() {
            const regionDropdownBtn = document.querySelector("#regionDropdownBtn");
            const regionDropdownMenu = document.querySelector("#regionDropdownMenu");
            const regionDropdownIcon = document.querySelector("#regionDropdownIcon");
            const regionSelectedText = document.querySelector("#regionSelectedText");
            const regionFilter = document.querySelector("#regionFilter");
            const regionOptions = document.querySelectorAll(".region-option");
            
            if (regionDropdownBtn && regionDropdownMenu) {
                // 드롭다운 버튼 클릭 시 메뉴 토글
                regionDropdownBtn.addEventListener("click", function(e) {
                    e.stopPropagation();
                    const isHidden = regionDropdownMenu.classList.contains("hidden");
                    if (isHidden) {
                        regionDropdownMenu.classList.remove("hidden");
                        regionDropdownIcon.classList.add("rotate-180");
                    } else {
                        regionDropdownMenu.classList.add("hidden");
                        regionDropdownIcon.classList.remove("rotate-180");
                    }
                });
                
                // 옵션 선택 시
                regionOptions.forEach(function(option) {
                    option.addEventListener("click", function(e) {
                        const value = option.getAttribute("data-value");
                        const text = option.textContent.trim();
                        
                        // 선택된 텍스트 업데이트
                        regionSelectedText.textContent = text;
                        
                        // 숨겨진 select 값 업데이트
                        if (regionFilter) {
                            regionFilter.value = value;
                            // change 이벤트 트리거
                            const changeEvent = new Event('change', { bubbles: true });
                            regionFilter.dispatchEvent(changeEvent);
                        }
                        
                        // 선택된 옵션 하이라이트
                        regionOptions.forEach(function(opt) {
                            opt.classList.remove("bg-main", "text-white");
                            opt.classList.add("text-gray-700");
                        });
                        option.classList.add("bg-main", "text-white");
                        option.classList.remove("text-gray-700");
                        
                        // 드롭다운 닫기
                        regionDropdownMenu.classList.add("hidden");
                        regionDropdownIcon.classList.remove("rotate-180");
                    });
                });
                
                // 외부 클릭 시 드롭다운 닫기
                document.addEventListener("click", function(e) {
                    if (!regionDropdownBtn.contains(e.target) && !regionDropdownMenu.contains(e.target)) {
                        regionDropdownMenu.classList.add("hidden");
                        regionDropdownIcon.classList.remove("rotate-180");
                    }
                });
            }
        });
    </script>
</div>


